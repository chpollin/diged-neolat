<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editorial Introduction - Lucina Digital Edition</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            background: linear-gradient(135deg, #fafaf8 0%, #f0f0ed 100%);
            min-height: 100vh;
        }
        
        .editorial-hero {
            background: linear-gradient(135deg, #1e3a5f 0%, #2a4a7f 100%);
            color: white;
            padding: 4rem 2rem;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .editorial-hero h1 {
            font-size: 3rem;
            font-weight: 300;
            margin: 0;
            letter-spacing: 2px;
            color: white;
        }
        
        .editorial-hero p {
            font-size: 1.2rem;
            margin-top: 1rem;
            opacity: 0.9;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .editorial-container {
            max-width: 1200px;
            margin: -3rem auto 0;
            padding: 0 2rem 4rem;
            position: relative;
            z-index: 1;
        }
        
        .content-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            padding: 3rem;
            margin-bottom: 2rem;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .content-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.12);
        }
        
        .section-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #1e3a5f 0%, #3a5a8f 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 1.5rem;
            color: white;
        }
        
        .content-card h2 {
            color: #1e3a5f;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
            border: none;
            padding: 0;
        }
        
        .content-card h3 {
            color: #2a4a7f;
            font-size: 1.3rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .content-card p {
            line-height: 1.8;
            color: #495057;
            font-size: 1.05rem;
            margin-bottom: 1.5rem;
        }
        
        /* Replace bullet lists with cards */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #1e3a5f;
            transition: all 0.3s;
        }
        
        .feature-card:hover {
            background: #e9ecef;
            transform: translateX(4px);
        }
        
        .feature-card strong {
            color: #1e3a5f;
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .feature-card p {
            margin: 0;
            font-size: 0.95rem;
            color: #6c757d;
        }
        
        /* Meter definitions as elegant table */
        .meter-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 2rem 0;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 0 0 1px #e9ecef;
        }
        
        .meter-table th {
            background: linear-gradient(135deg, #1e3a5f 0%, #2a4a7f 100%);
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 500;
        }
        
        .meter-table td {
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
            background: white;
        }
        
        .meter-table tr:hover td {
            background: #f8f9fa;
        }
        
        .meter-table tr:last-child td {
            border-bottom: none;
        }
        
        .meter-abbr {
            font-weight: 600;
            color: #1e3a5f;
            font-family: 'Courier New', monospace;
        }
        
        .meter-pattern {
            font-family: 'Courier New', monospace;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        /* Stats as visual cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e3a5f;
            display: block;
        }
        
        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 0.5rem;
        }
        
        .loading-message {
            text-align: center;
            padding: 4rem;
            color: #6c757d;
        }
        
        .loading-message::after {
            content: '';
            width: 40px;
            height: 40px;
            margin: 2rem auto 0;
            display: block;
            border: 3px solid #e9ecef;
            border-top-color: #1e3a5f;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem auto;
            max-width: 600px;
            text-align: center;
        }
        
        /* Navigation pills */
        .section-nav {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            overflow-x: auto;
        }
        
        .section-nav a {
            padding: 0.75rem 1.5rem;
            background: white;
            border-radius: 8px;
            color: #495057;
            text-decoration: none;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .section-nav a:hover {
            background: #1e3a5f;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <header class="nav" role="banner">
        <div class="nav-left">
            <div class="brand">Lucina Digital Edition</div>
            <a href="index.html" class="nav-link-btn">‚Üê Back to Edition</a>
            <a href="about.html" class="nav-link-btn">About</a>
            <button class="nav-link-btn active">Editorial Introduction</button>
            <a href="indices.html" class="nav-link-btn">Index</a>
        </div>
    </header>

    <div class="editorial-hero">
        <h1>Editorial Introduction</h1>
        <p>A comprehensive guide to the edition of Aurelius Laurentius Albrisius's Lucina</p>
    </div>

    <main class="editorial-container">
        <div id="editorialContent" class="loading-message">
            Loading editorial information...
        </div>
    </main>

    <script>
        // Load and parse TEI for editorial content
        async function loadEditorialContent() {
            try {
                const response = await fetch('./tei-final-3-4.xml');
                const xmlText = await response.text();
                const parser = new DOMParser();
                const teiDoc = parser.parseFromString(xmlText, 'text/xml');
                
                // Check for parsing errors
                if (teiDoc.querySelector('parsererror')) {
                    throw new Error('Failed to parse TEI XML');
                }
                
                displayEditorialContent(teiDoc);
            } catch (error) {
                document.getElementById('editorialContent').innerHTML = `
                    <div class="error-message">
                        <strong>Failed to load editorial content</strong><br>
                        ${error.message}
                    </div>
                `;
            }
        }
        
        function displayEditorialContent(teiDoc) {
            const container = document.getElementById('editorialContent');
            let html = '';
            
            // Quick navigation
            html += `
                <div class="section-nav">
                    <a href="#context">Historical Context</a>
                    <a href="#structure">Work Structure</a>
                    <a href="#literary">Literary Models</a>
                    <a href="#genres">Genres</a>
                    <a href="#meters">Metrical Forms</a>
                    <a href="#editorial">Editorial Principles</a>
                </div>
            `;
            
            // The Work and Its Context
            const msDesc = teiDoc.querySelector('msDesc');
            const msContents = msDesc?.querySelector('msContents');
            if (msContents) {
                html += `
                    <div class="content-card" id="context">
                        <div class="section-icon">üìú</div>
                        <h2>The Work and Its Context</h2>
                `;
                
                const summary = msContents.querySelector('summary');
                if (summary) {
                    html += `<p>${summary.textContent}</p>`;
                }
                
                // Historical Context
                const originNote = teiDoc.querySelector('history origin note')?.textContent;
                if (originNote) {
                    html += `<h3>Historical Context</h3><p>${originNote}</p>`;
                }
                
                html += '</div>';
            }
            
            // Structure of the Work
            const msItems = msContents?.querySelectorAll('msItem[n]');
            if (msItems && msItems.length > 0) {
                html += `
                    <div class="content-card" id="structure">
                        <div class="section-icon">üìö</div>
                        <h2>Structure of the Work</h2>
                        <p>The collection is organized into four distinct books:</p>
                        <div class="feature-grid">
                `;
                
                msItems.forEach(item => {
                    const title = item.querySelector('title')?.textContent;
                    const rubric = item.querySelector('rubric')?.textContent;
                    const note = item.querySelector('note')?.textContent;
                    
                    if (title) {
                        html += `
                            <div class="feature-card">
                                <strong>${title}</strong>
                                <p>${rubric || ''} ${note || ''}</p>
                            </div>
                        `;
                    }
                });
                
                // Add colophon if present
                const colophon = msContents?.querySelector('colophon')?.textContent;
                if (colophon) {
                    html += `
                        <div class="feature-card">
                            <strong>Colophon</strong>
                            <p>${colophon}</p>
                        </div>
                    `;
                }
                
                html += '</div></div>';
            }
            
            // Literary Context
            const litModels = teiDoc.querySelector('listBibl[type="literary-models"]');
            if (litModels) {
                const bibls = litModels.querySelectorAll('bibl');
                if (bibls.length > 0) {
                    html += `
                        <div class="content-card" id="literary">
                            <div class="section-icon">üèõÔ∏è</div>
                            <h2>Literary Models & Influences</h2>
                            <p>Albrisius draws upon a rich tradition of classical and contemporary sources:</p>
                            <div class="feature-grid">
                    `;
                    bibls.forEach(bibl => {
                        const text = bibl.textContent;
                        const [author, ...rest] = text.split(':');
                        html += `
                            <div class="feature-card">
                                <strong>${author}</strong>
                                <p>${rest.join(':') || ''}</p>
                            </div>
                        `;
                    });
                    html += '</div></div>';
                }
            }
            
            // Genre Categories
            const genres = teiDoc.querySelectorAll('taxonomy[xml\\:id="genres"] category');
            if (genres.length > 0) {
                html += `
                    <div class="content-card" id="genres">
                        <div class="section-icon">‚úçÔ∏è</div>
                        <h2>Genre Categories</h2>
                        <p>The poems represent a wide range of occasional poetry typical of the Quattrocento:</p>
                        <div class="feature-grid">
                `;
                genres.forEach(genre => {
                    const catDesc = genre.querySelector('catDesc')?.textContent;
                    const catId = genre.getAttribute('xml:id');
                    if (catDesc) {
                        html += `
                            <div class="feature-card">
                                <strong>${catId?.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()) || 'Genre'}</strong>
                                <p>${catDesc}</p>
                            </div>
                        `;
                    }
                });
                html += '</div></div>';
            }
            
            // Metrical Forms
            const meters = teiDoc.querySelectorAll('metDecl metSym');
            if (meters.length > 0) {
                html += `
                    <div class="content-card" id="meters">
                        <div class="section-icon">üìè</div>
                        <h2>Metrical Forms</h2>
                        <p>The collection employs various classical meters:</p>
                        <table class="meter-table">
                            <thead>
                                <tr>
                                    <th>Meter</th>
                                    <th>Pattern</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                meters.forEach(meter => {
                    const abbr = meter.getAttribute('value');
                    const termText = meter.querySelector('term')?.textContent || '';
                    const pattern = termText.match(/Pattern: ([^.]+)/)?.[1] || '';
                    const desc = meter.querySelector('desc p')?.textContent || termText;
                    
                    html += `
                        <tr>
                            <td><span class="meter-abbr">${abbr}</span></td>
                            <td><span class="meter-pattern">${pattern}</span></td>
                            <td>${desc.replace(/Pattern: [^.]+\.?/, '').trim()}</td>
                        </tr>
                    `;
                });
                
                html += '</tbody></table></div>';
            }
            
            // Editorial Principles
            const editorialDecl = teiDoc.querySelector('editorialDecl');
            if (editorialDecl) {
                html += `
                    <div class="content-card" id="editorial">
                        <div class="section-icon">üìù</div>
                        <h2>Editorial Principles</h2>
                `;
                
                const corrections = editorialDecl.querySelector('correction p')?.textContent;
                const normalization = editorialDecl.querySelector('normalization p')?.textContent;
                const punctuation = editorialDecl.querySelector('punctuation p')?.textContent;
                
                if (corrections || normalization || punctuation) {
                    html += '<div class="feature-grid">';
                    
                    if (corrections) {
                        html += `
                            <div class="feature-card">
                                <strong>Corrections</strong>
                                <p>${corrections}</p>
                            </div>
                        `;
                    }
                    
                    if (normalization) {
                        html += `
                            <div class="feature-card">
                                <strong>Normalization</strong>
                                <p>${normalization}</p>
                            </div>
                        `;
                    }
                    
                    if (punctuation) {
                        html += `
                            <div class="feature-card">
                                <strong>Punctuation</strong>
                                <p>${punctuation}</p>
                            </div>
                        `;
                    }
                    
                    html += '</div>';
                }
                
                html += '</div>';
            }
            
            // Statistics
            const poems = teiDoc.querySelectorAll('div[type="poem"]');
            const persons = teiDoc.querySelectorAll('person');
            const places = teiDoc.querySelectorAll('place');
            
            html += `
                <div class="content-card">
                    <div class="section-icon">üìä</div>
                    <h2>Edition Statistics</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span class="stat-number">${poems.length}</span>
                            <span class="stat-label">Poems</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">${persons.length}</span>
                            <span class="stat-label">Persons</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">${places.length}</span>
                            <span class="stat-label">Places</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number">4</span>
                            <span class="stat-label">Books</span>
                        </div>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }
        
        // Load content when page loads
        document.addEventListener('DOMContentLoaded', loadEditorialContent);
    </script>
</body>
</html>